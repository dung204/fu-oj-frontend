# Internationlization (i18n)

## 1. Before we start

This template supports internationalization (i18n) using [paraglide-js](https://inlang.com/m/gerre34r/library-inlang-paraglideJs).

The way it works is that all the messages (text) in the application are stored in JSON files in the `messages/` folder. Each file corresponds to a language, and the file name is the language code (e.g. `en.json` for English, `vi.json` for Vietnamese, etc.).

When the application is running in dev mode, the i18n messages will be compiled into JavaScript files and stored in the `src/i18n/` folder. The application will then use these compiled files to display the messages in the appropriate language.

Hence, it is recommended to always run the application in dev mode when working with i18n messages, so that any changes to the messages are reflected immediately.

Head over to [paraglide-js documentation](https://inlang.com/m/gerre34r/library-inlang-paraglideJs) for more information on how to use the library.

## 2. Working with i18n messages

The i18n messages are JSON files stored in the messages/ folder. The file names are the language codes (e.g. en.json, vi.json, etc.) and the contents of the files are the translations for the messages in that language. The structure of the files is as follows:

```jsonc
{
  "base": {
    "components": {
      "DatePicker": {
        "placeholder": "Pick a date",
      },
      // ... other components
    },
    // ...
  },
  "modules": {
    "auth": {
      "components": {
        "LoginForm": {
          // ... messages
        },
        // ... other components
      },
      "pages": {
        "Login": {
          "title": "Login",
          "description": "Please enter your credentials to login.",
        },
        // ... other pages
      },
      // ...
    },
  },
}
```

To use the i18n messages in your components or pages, there are two main ways:

> ⚠️ Make sure to run the application in dev mode (`bun dev`) to ensure that the i18n messages are compiled and available for use.

1. Import the `m` object from `@/i18n/messages`, which contains all the messages:

```tsx
import { m } from "@/i18n/messages";

function MyComponent() {
  return <h1>{m["base.components.DatePicker.placeholder"]()}</h1>;
}
```

> ⚠️ Note that the message key (`base.components.DatePicker.placeholder`) have to be accessed using [bracket notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Property_accessors#bracket_notation), not [dot notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Property_accessors#dot_notation).
> Which means that this will NOT work: `m.base.components.DatePicker.placeholder()`

2. **(Recommended)** Use the `getTranslation` utility function to retrieve specific messages:

```tsx
import { getTranslation } from "@/base/utils";

function MyComponent() {
  return <h1>{getTranslation("base.components.DatePicker.placeholder")}</h1>;
}
```

This function will check if the message exists and return a fallback if it doesn't. The fallback is the key itself.

## 2. Adding a new language

To add a new language, follow these steps:

1. Go to [`i18n/settings.json`](../i18n/settings.json) and add the new language code to the `locales` array.

```jsonc
{
  "$schema": "https://inlang.com/schema/project-settings",
  "baseLocale": "en",
  "locales": [
    "en",
    "vi",
    "fr", // Add your new language code here
  ],
  "modules": [
    "https://cdn.jsdelivr.net/npm/@inlang/plugin-message-format@4/dist/index.js",
    "https://cdn.jsdelivr.net/npm/@inlang/plugin-m-function-matcher@2/dist/index.js",
  ],
  "plugin.inlang.messageFormat": {
    "pathPattern": "./messages/{locale}.json",
  },
}
```

2. Create a new JSON file in the `messages/` folder with the name of the new language code (e.g. `fr.json` for French).

```jsonc
{
  "base": {
    "components": {
      "DatePicker": {
        "placeholder": "Choisir une date",
      },
    },
  },
}
```

## 3. Conventions for i18n messages:

1. For each file name in the `src/` folder, follow this convention:
   - First, get the path of the file relative to the `src/` folder. For example, given the file `src/modules/auth/pages/Login.tsx`, the relative path will be `modules/auth/pages/Login.tsx`.
   - Remove the file extension. The relative path becomes `modules/auth/pages/Login`.
   - Replace all `/` with `.`. The final key prefix is `modules.auth.pages.Login`. Which can be presented as JSON object like this:

```jsonc
{
  "modules": {
    "auth": {
      "pages": {
        "Login": {
          // ... messages
        },
      },
    },
  },
}
```

2. There are no restrictions on the keys used in the messages. However, it is recommended to use descriptive keys that indicate where the message is used.

## 4. I18n for the `<Form />` component

See the [8. Internationalization (i18n) of the `<Form />` component document](./form.md#8-internationalization-i18n) for more details on how to use i18n messages in the `<Form />` component.
